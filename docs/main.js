(()=>{const e=document.getElementById("board300"),t=document.getElementById("board28"),n=document.getElementById("buttonErase"),i=document.getElementById("prediction"),l=e.getContext("2d"),d=t.getContext("2d");let o,a=!1,c=0,r=0,g=0,h=0;const s=t=>t-e.getBoundingClientRect().left,m=t=>t-e.getBoundingClientRect().top;l.fillStyle="black",l.fillRect(0,0,e.width,e.height);const u=()=>{a=!1,y()},y=()=>{let e=f(),t=o.predict(e).dataSync();for(let e=0;e<t.length;e++)document.getElementById(`prediction${e}`).innerText=Number(+t[e]).toFixed(3);i.innerText=t.indexOf(Math.max(...t))},f=()=>{d.filter="blur(0.470px)",d.drawImage(l.canvas,0,0,t.width,t.height);const e=d.getImageData(0,0,t.width,t.height);let n=[];for(let t=0;t<e.data.length;t+=4)n.push(e.data[t]/255);return n=tf.reshape(n,[1,28,28,1]),n};e.addEventListener("mousedown",(e=>{c=g,r=h,g=s(e.clientX),h=m(e.clientY),l.beginPath(),l.fillStyle="black",l.lineTo(g,h),l.closePath(),a=!0})),e.addEventListener("mouseup",u),e.addEventListener("mouseout",u),e.addEventListener("mousemove",(e=>{a&&(c=g,r=h,g=s(e.clientX),h=m(e.clientY),l.beginPath(),l.moveTo(c,r),l.lineTo(g,h),l.strokeStyle="white",l.lineWidth=30,l.lineCap="round",l.stroke(),l.closePath())})),n.addEventListener("click",(()=>{l.fillStyle="black",l.fillRect(0,0,e.width,e.height),i.innerText="-"})),(async()=>{o=await tf.loadLayersModel("https://pegadro.github.io/digit-recognition-playground/model.json")})()})();